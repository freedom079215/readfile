<!DOCTYPE html>
<html>
<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">

<script>        
  var file_text = new String
  function handleFileSelect()
  {               
    if (!window.File || !window.FileReader || !window.FileList || !window.Blob) {
      alert('The File APIs are not fully supported in this browser.');
      return;
    }   

    input = document.getElementById('fileinput');
    if (!input) {
      alert("Um, couldn't find the fileinput element.");
    }
    else if (!input.files) {
      alert("This browser doesn't seem to support the `files` property of file inputs.");
    }
    else if (!input.files[0]) {
      alert("Please select a file before clicking 'Load'");               
    }
    else {
      file = input.files[0];
      fr = new FileReader();
      fr.onload = receivedText;
      fr.readAsText(file);
      //fr.readAsDataURL(file);
      file_text = fr.result
    }
  }

  function receivedText() {
    document.getElementById('editor').appendChild(document.createTextNode(fr.result));

  }           

</script>

<script>
var link_ID = new Array;
var button_ID = new Array;
var gacode = new Array;
var gacode_str = new String;
$(document).ready(function(){

     $("#analyze").click(function(){
      $( "#GACode" ).load( "ts.htm" );

          console.log('test')
          $.get("ts.htm");
      })
  })

jQuery.fn.extend({
    getPath: function () {
      $(this).click(function(){
        var path, node = this;
        while (node.length) {
            var realNode = node[0], name = realNode.localName;
            if (!name) break;
            name = name.toLowerCase();

            var parent = node.parent();

            var sameTagSiblings = parent.children(name);
            if (sameTagSiblings.length > 1) { 
                allSiblings = parent.children();
                var index = allSiblings.index(realNode) + 1;
                if (index > 1) {
                    name += ':nth-child(' + index + ')';
                }
            }

            path = name + (path ? '>' + path : '');
            node = parent;
        }
        console.log(path)
        return path;
      })
    }
});

</script>
</head>
<body>
      <ul class="nav nav-tabs">
        <li class="nav-item">
          <a class="nav-link active" href="#">數位足跡追蹤碼產生器</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">說明</a>
        </li>
      </ul>
      <div class="container" id='bodycontainer'>
            <div class="row">
              <div class="col-sm">
                  <label>選擇網頁檔案: </label><input type="file" id="fileinput"/>
                  <button class="btn btn-secondary" id='btnLoad' onclick='handleFileSelect();'>LOAD</button>
              </div>   
              <div class="col-sm">
                  <button id="analyze" class="btn btn-primary">分析網頁資料</button>
              <div class="col-sm">

                  <button id="analyze2" class="btn btn-primary">分析網頁資料2</button>
              </div>
              </div>
              <div class="col-sm">
                  <button id='send' class="btn btn-primary">產出GACode</button>
              </div>
              <div class="col-sm">
                  <button class="btn btn-light"><a href="#" id="downloadLink">下載GA追蹤碼js</a></button>
              </div>

            </div>

           <div class="row">
                  <div class="col">
                        <div id="GACode">testetsetset<br></div>
                  </div>
           </div>
            <p></p>
            <div class="row" id="editor"></div>
            <div id="main">
                <span>讀入網頁代碼</span>
            </div>
      </div>


</body>

</html>
<script type="text/javascript">
      var fileName =  'GACode.js'; // You can use the .txt extension if you want

      $('#downloadLink').click(function(){
          downloadInnerHtml(fileName, 'GACode','text/html');
          console.log('click')
      });
</script>
<script type="text/javascript">
  $("#analyze2").click(function(){

    // $( "#GACode" ).find( "*" )
    //   .css({"border-style": "solid","border-color": "coral"})
    //   .click(function(){
    //     alert('ok')
    //   });
    //$( "body" ).prepend( "<h3>" + elementCount + " elements found</h3>" );
  })
  $("#GACode").getPath();
</script>
